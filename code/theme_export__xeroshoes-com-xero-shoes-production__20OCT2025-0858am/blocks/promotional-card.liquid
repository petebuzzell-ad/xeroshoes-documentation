<div class="card card-product card-product-promo mb-lg-0 mb-1 border-0 {{ block.settings.content_position }} {{ block.settings.width }}">
    {% liquid 
        assign desktop_image_size_width = 0.5
        if block.settings.width == 'grid-span-2'
            assign desktop_image_size_width = 0.75
        endif
    %}
    <div class="card-img card-img position-relative">
        {%- render 'picture-tag'
                image: block.settings.image_desktop
                mobile_image: block.settings.image_mobile
                class: 'img-fluid h-100 flex-1 object-fit-cover w-100' 
                desktop_image_size_width: desktop_image_size_width
                 -%}
                {% if block.settings.enable_overlay %}
                    <div class="overlay" style="background: {{ block.settings.overlay_bg_color }}!important; opacity: {{ block.settings.overlay_opacity }}!important; mix-blend-mode: {{ block.settings.blend_mode }};"></div>
                {% endif %}
    </div>
    <div class="card-body px-0 pb-0">
        <div class="row no-gutter">
            <div class="col-12">
                {% content_for "blocks" %}
            </div>
        </div>
    </div>
</div>

{% schema %}
    { 
        "name": "Promotional card",
        "tag": null,
        "blocks": [{ "type": "@theme" }, { "type": "@app" }],
        "settings": [
            {
                "type": "image_picker",
                "id": "image_desktop",
                "label": "Desktop Image"
            },
            {
                "type": "image_picker",
                "id": "image_mobile",
                "label": "Mobile Image"
            },
            {
                "type": "select",
                "id": "content_position",
                "label": "Content Position",
                "options": [
                    {
                        "value": "above-image",
                        "label": "Above Image"
                    },
                    {
                        "value": "below_image",
                        "label": "Below Image"
                    }
                ],
                "default": "below_image"
            },
            {
                "type": "select",
                "id": "width",
                "label": "Width",
                "options": [
                    {
                        "value": "",
                        "label": "Default"
                    },
                    {
                        "value": "grid-span-2",
                        "label": "Wide"
                    }
                ],
                "default": ""
            },
            {
                "type": "header",
                "content": "Image Overlay"
            },
            {
                "type": "checkbox",
                "id": "enable_overlay",
                "label": "t:settings.overlay",
                "default": false
            },
            {
                "type": "color_background",
                "id": "overlay_bg_color",
                "label": "t:settings.overlay_color",
                "default": "#000000",
                "visible_if": "{{ block.settings.enable_overlay == true }}"
            },
            {
                "type": "range",
                "id": "overlay_opacity",
                "label": "t:settings.overlay_opacity",
                "min": 0.1,
                "max": 1,
                "step": 0.1,
                "default": 0.5,
                "visible_if": "{{ block.settings.enable_overlay == true }}"
            },
            {
                "type": "select",
                "id": "blend_mode",
                "label": "Mix Blend Mode",
                "visible_if": "{{ block.settings.enable_overlay == true }}",
                "options": [
                    {
                        "value": "multiply",
                        "label": "Multiply"
                    },
                    {
                        "value": "darken",
                        "label": "Darken"
                    },
                    {
                        "value": "lighten",
                        "label": "Lighten"
                    },
                    {
                        "value": "soft-light",
                        "label": "Soft Light"
                    },
                    {
                        "value": "none",
                        "label": "None"
                    }
                ],
                "default": "none"
            }
        ],
        "presets": [
            {
                "name": "Promotional card"
            }
        ]
    }
{% endschema %}